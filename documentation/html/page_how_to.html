<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>WPDK: How to write a simple Plugin</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree-override.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-160x160.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">WPDK
   &#160;<span id="projectnumber">1.1.2</span>
   </div>
   <div id="projectbrief">WordPress Development Kit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_how_to.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">How to write a simple Plugin </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="page_how_to_plugin_1"></a>
Overview</h1>
<p>The main class of your WPDK plugin for WordPress, your "plugin" from now on, is declared and engaged in the plugin main file, the one that contains the comment header used by WordPress to recognize and extract informations about any plugin.</p>
<p>Let's assume that you are creating a new plugin for WordPress, named <code>Test Plugin</code>.</p>
<p>In the root directory of your plugin create a file named <code>wpdk-testplugin.php</code>. Inside this file, insert the WordPress standard comment for recognize this plugin as: </p>
<pre class="fragment">/**
 * Plugin Name: CleanFix
 * Plugin URI: https://wpxtre.me
 * Description: Clean and fix tools
 * Version: 1.0.0
 * Author: You
 * Author URI: http://your-domain.com
 */

 /* 1. Include WPDK. */
 require_once( trailingslashit( dirname( __FILE__ ) ) . 'wpdk/wpdk.php' );

 /* 2. Define of include your main plugin class. */
 if ( !class_exists( 'WPDKTestPlugin' ) ) {
   class WPDKTestPlugin extends WPDKWordPressPlugin {
   ....
   }
 }
</pre><p>Please note the declaration of a class named <code>WPDKTestPlugin</code>, that extends <code><a class="el" href="classWPDKWordPressPlugin.html">WPDKWordPressPlugin</a></code> class.</p>
<p>This is the main class of your plugin. Through it, you can control every aspect of your plugin and manage what to do exactly where you want ( in WordPress front end, in WordPress admin area, in both worlds, and so on ). Using this class as a manager, you can write all code you need to fulfil the scope of your plugin.</p>
<p>When WordPress loads your plugin through this file, this class is also engaged, through the line: </p>
<pre class="fragment">$GLOBALS['WPDKTestPlugin'] = new WPDKTestPlugin();
</pre><p>at the end of the class definition. In this way, your plugin becomes up and running, obviously if it was previously activated.</p>
<p>For a better comprehension, we have to deepen the behaviour of the <code><a class="el" href="classWPDKWordPressPlugin.html">WPDKWordPressPlugin</a></code> class, because your main class inherits all things it needs directly from it.</p>
<h1><a class="anchor" id="page_how_to_plugin_2"></a>
WPDKWordPressPlugin class</h1>
<p>The <code><a class="el" href="classWPDKWordPressPlugin.html">WPDKWordPressPlugin</a></code> class is the most important class of the whole WordPress Development Kit (WPDK). It performs all init procedures for a plugin in order to make it compatible with the WPDK standard.</p>
<p>This class provides the fundamental startup of a WPDK plugin. You rarely (never) instantiate <code><a class="el" href="classWPDKWordPressPlugin.html">WPDKWordPressPlugin</a></code> object directly. Instead, you instantiate subclasses of the <code><a class="el" href="classWPDKWordPressPlugin.html">WPDKWordPressPlugin</a></code> class.</p>
<p>So, this class <b>must</b> be used to extend the main class of your WPDK plugin: its function is to initialize the environment in which the plugin itself operates, and record the plugin for updates incoming from WPDK Store.</p>
<p>In addition to initializing and recording, <code><a class="el" href="classWPDKWordPressPlugin.html">WPDKWordPressPlugin</a></code> class performs automatically for you a large series of standard procedures needed in normal coding of a WordPress standard Plugin, and gives access to a lot of properties and methods really useful:</p>
<ul>
<li>Gets directly from WordPress comments information about your plugin : plugin name, version, the text and the text domain path.</li>
</ul>
<ul>
<li>Prepares a set of standard properties with paths and urls most commonly used.</li>
<li>Provides a lot of hooks to wrap (filters and actions) among the most used in WordPress environment.</li>
<li>Prepare an instance of <code>WPDKWatchDog</code> object for your own log.</li>
</ul>
<p>All properties and methods of this class has been documented in <code>PHPDoc</code> format compatible with <code>Doxygen</code> tool, so you can extract all detailed info and help through your PHP IDE. Describing in details the WPDK framework is outside the scope of this document.</p>
<h1><a class="anchor" id="page_how_to_plugin_2_1"></a>
Filesystem guideline</h1>
<p>In order to get all benefit from WPDK framework we suggest to you to use the standard organization for the filesystem. The WPDK framework prepare for you a set of standard folder reference properties to access to the main plugin or theme resource. For instance see below a standard plugin filesystem structure:</p>
<ul>
<li><b>Your Plugin folder</b><ul>
<li>assets/<ul>
<li>css/<ul>
<li>images</li>
</ul>
</li>
<li>js/</li>
</ul>
</li>
<li>classes/</li>
<li>localization/</li>
</ul>
</li>
</ul>
<h3>Useful assets</h3>
<p>In addition WPDK framework also provides a <code>database</code> folder:</p>
<ul>
<li><b>Your Plugin folder</b><ul>
<li>assets/<ul>
<li>css/<ul>
<li>images</li>
</ul>
</li>
<li>js/</li>
</ul>
</li>
<li>classes/</li>
<li>localization/</li>
<li>database/</li>
</ul>
</li>
</ul>
<p>This filesystem tree is mapped into the follow properties: </p>
<pre class="fragment">$this-&gt;path
$this-&gt;classesPath
$this-&gt;databasePath
</pre><p>In addition you can use the <code>http</code> URL version of: </p>
<pre class="fragment">$this-&gt;url
$this-&gt;assetsURL
$this-&gt;cssURL
$this-&gt;imagesURL
$this-&gt;javascriptURL
</pre><h1><a class="anchor" id="page_how_to_plugin_3"></a>
The basic execution flow of a WPDK plugin</h1>
<p>Now that you have properly obtained and configured your basic WPDK plugin framework, it's time to write your code in order to put the right things in the right place.</p>
<p>Let's always assume that you are created a new WPDK plugin for WordPress, named <code>Test Plugin</code>, through the Product Generator of WPDK Developer Center. In the root directory of your plugin, you have a file named <code>wpx-testplugin.php</code>. Inside this file, you have the declaration of a class named <code>WPDKTestPlugin</code>, that extends <code><a class="el" href="classWPDKWordPressPlugin.html">WPDKWordPressPlugin</a></code> class. In this way: </p>
<pre class="fragment">if ( !class_exists( 'WPDKTestPlugin' ) ) {
  class WPDKTestPlugin extends WPDKWordPressPlugin {
  ....
  }
}
</pre><h1><a class="anchor" id="page_how_to_plugin_4"></a>
Plugin activation</h1>
<p>The method <code>activation</code> of your <code>WPDKTestPlugin</code> class is invoked every time your plugin is activated. Activation is not loading: the activation of a WordPress plugin happens just once, normally through <code>plugin</code> page of WordPress admin area, when a user choose to activate a plugin. From that moment on, the plugin becomes <em>active</em>, and this method is not invoked anymore.</p>
<p>The basic code of this method prepared for you through the Product Generator of WPDK Developer Center is this: </p>
<pre class="fragment">/* Hook when the plugin is activate - only first time. */
function activation() {
  /* To override. */
}
</pre><p>Here you can insert the code your plugin eventually needs to execute in plugin activation phase.</p>
<h1><a class="anchor" id="page_how_to_plugin_5"></a>
Plugin deactivation</h1>
<p>The method <code>deactivation</code> of your <code>WPDKTestPlugin</code> class is invoked every time your plugin is deactivated. The deactivation of a WordPress plugin happens just once, normally through <code>plugin</code> page of WordPress admin area, when a user choose to deactivate a plugin. From that moment on, the plugin becomes <em>inactive</em>, and this method is not invoked anymore.</p>
<p>The basic code of this method prepared for you through the Product Generator of WPDK Developer Center is this: </p>
<pre class="fragment">/* Hook when the plugin is deactivated. */
function deactivation() {
  /* To override. */
}
</pre><p>You can insert here the code your plugin eventually needs to execute in plugin deactivation phase.</p>
<h1><a class="anchor" id="page_how_to_plugin_6"></a>
Plugin configuration</h1>
<p>The method <code>loaded</code> of your <code>WPDKTestPlugin</code> class is invoked every time your plugin is loaded. Loading is not activation: every single time this plugin is loaded from WordPress environment, this method will be invoked.</p>
<p>The basic code of this method is not directly included in your main class. Nevertheless, it is in <code><a class="el" href="classWPDKWordPressPlugin.html">WPDKWordPressPlugin</a></code> class, so you can override it. If you need to execute some tasks every time your plugin is loaded, create this method in your main class: </p>
<pre class="fragment">function loaded() {
  /* You code. */
}
</pre><p>and then put your own specific code in it.</p>
<h1><a class="anchor" id="page_how_to_plugin_6"></a>
Plugin configuration</h1>
<p>The method <code>configuration</code> of your <code>WPDKTestPlugin</code> class is invoked every time your plugin is loaded. Loading is not activation: every single time this plugin is loaded from WordPress environment, this method will be invoked.</p>
<p>Here you can put all stuffs about the configuration of your plugin; it is a commodity: you can perform the same task in another way. Nevertheless, it can be really useful for you to use this hook, because this method is executed AFTER** the plugin has been fully loaded from WordPress environment.</p>
<p>The basic code of this method prepared for you through the Product Generator of WPDK Developer Center is this: </p>
<pre class="fragment">function configuration() {
    $this-&gt;config = WPDKTestPluginConfig::init();
}
</pre><p>The instance of <code>WPDKTestPluginConfig</code> is used to load and store the plugin settings on WordPress DB, according to WPDK framework specs. But you can safely use your own code. In any case, you can insert here the code your plugin eventually needs to execute in configuration phase.</p>
<h1><a class="anchor" id="page_how_to_plugin_7"></a>
Commodity</h1>
<p>Your main class has also some commodity methods, useful to group together some similar tasks.</p>
<p>In the method <code>defines</code>, you can insert the definition of all <em>PHP</em> <code>define</code> used by your class.</p>
<p>The basic code of this method prepared for you through the Product Generator of WPDK Developer Center is this: </p>
<pre class="fragment">public function defines() {
    include_once( 'defines.php' );
}
</pre><p>You can write your own <em>PHP</em> <code>define</code> directly in this method, or you can also put your <code>define</code> in file <code>defines.php</code>, stored in your plugin root directory, and included by this method.</p>
<p>In the method <code>includes</code>, you can include all <em>PHP</em> files used by your class, through <em>PHP</em> directives <code>include</code>, <code>require</code>, <code>require_once</code>, ecc.</p>
<p>The basic code of this method prepared for you through the Product Generator of WPDK Developer Center is this: </p>
<pre class="fragment">public static function includes() {
    /* Includes all your class file here. */

    /* Core. */
    require_once( $this-&gt;classesPath . 'core/wpdk-testplugin-configuration.php' );
}
</pre><p>The line: </p>
<pre class="fragment">require_once( $this-&gt;classesPath . 'core/wpdk-testplugin--configuration.php' );
</pre><p>is necessary for your plugin configuration core.</p>
<p>Both <code>includes()</code> and <code>defines()</code> methods are invoked in the <code>WPDKTestPlugin</code> constructor.</p>
<h1><a class="anchor" id="page_how_to_plugin_8"></a>
Writing code in your plugin specifically related to WordPress admin area</h1>
<p>Let's always assume that you created a new WPDK plugin for WordPress, named <code>Test Plugin</code>. In the root directory of your plugin, you have a file named <code>wpdk-testplugin.php</code>. Inside this file, you have the declaration of a class named <code>WPDKTestPlugin</code>, that extends <code><a class="el" href="classWPDKWordPressPlugin.html">WPDKWordPressPlugin</a></code> class.</p>
<p>The method <code>theme</code> of your <code>WPDKTestPlugin</code> class is called every time your plugin is loaded, after the invocation of methods <code>loaded</code> and <code>configuration</code>; but this calling happens <em>if, and only if, the web request is related to the front-end side of WordPress</em>: that is to say, not related in any way to the admin side of WordPress. Loading is not activation: every single time this plugin is loaded from WordPress environment, this method will be invoked.</p>
<p>The basic code of this method prepared for you through the Product Generator of WPDK Developer Center is this: </p>
<pre class="fragment">function theme() {
     /* To override. */
}
</pre><p>In this method, you can insert all code your plugin needs to execute in the front-end area of your WordPress environment. For example, you can insert here the declaration of a specific class that handles all stuffs about front-end area. Or you can directly add here some specific hooks related to front-end WordPress filters, like <code>the_title</code> or <code>the_content</code>.</p>
<p>For example, the WPXtreme WordPress plugin overwrites this method in this way: </p>
<pre class="fragment">function theme() {
  require_once( $this-&gt;classesPath . 'frontend/wpdk-testplugin-frontend.php' );
  $frontend = new WPDKTestPluginFrontend( $this );
}
</pre><p>All code of this plugin related to the WordPress frontend area is hence encapsulated inside the <code>WPXtremeFrontend</code> object, thus giving a plugin more readability and flow comprehension.</p>
<h1><a class="anchor" id="page_how_to_plugin_8"></a>
Writing code in your plugin specifically related to WordPress admin area</h1>
<p>Let's always assume that you created a new WPDK plugin for WordPress, named <code>Test Plugin</code>. In the root directory of your plugin, you have a file named <code>wpdk-testplugin.php</code>. Inside this file, you have the declaration of a class named <code>WPDKTestPlugin</code>, that extends <code><a class="el" href="classWPDKWordPressPlugin.html">WPDKWordPressPlugin</a></code> class.</p>
<p>The method <code>admin</code> of your <code>WPDKTestPlugin</code> class is called every time your plugin is loaded, after the invocation of methods <code>loaded</code> and <code>configuration</code>; but this calling happens <em>if, and only if, the web request is related to the admin side of WordPress</em>. Loading is not activation: every single time this plugin is loaded from WordPress environment, this method will be invoked.</p>
<p>The basic code of this method prepared for you through the Product Generator of WPDK Developer Center is this: </p>
<pre class="fragment">function admin() {
  require_once( $this-&gt;classesPath . 'admin/wpdk-testplugin-admin.php' );
  $admin = new WPDKTestPluginAdmin( $this );
}
</pre><p>In this method, you can insert all code your plugin needs to execute in the admin area of your WordPress environment. For example, you can insert here the declaration of a specific class that handles all stuffs about admin area. Or you can directly add here some specific hooks related to administration WordPress filters, like <code>menu_order</code> or <code>admin_head</code>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="wpdk-footer"></div>
